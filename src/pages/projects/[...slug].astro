---
import { getCollection } from 'astro:content';
import CustomCursor from '../../components/CustomCursor';
import '../../styles/global.css';

export async function getStaticPaths() {
  const projectEntries = await getCollection('projects');
  return projectEntries.map(entry => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>{entry.data.title} | Portfolio</title>
  </head>
  <body class="bg-black text-white antialiased overflow-y-auto">
    <CustomCursor client:only="react" />
    <main class="max-w-5xl mx-auto px-6 py-20">
      <nav class="mb-12">
        <a href="/" class="text-[10px] font-black uppercase tracking-[0.4em] text-zinc-500 hover:text-blue-500">‚Üê Back</a>
      </nav>

      <header class="mb-16">
        <h1 class="text-6xl md:text-8xl font-black uppercase leading-[0.8]">{entry.data.title}</h1>
      </header>

      <div class="relative w-full rounded-[2.5rem] overflow-hidden border border-zinc-800 bg-zinc-900 mb-20 shadow-2xl group">
        
        {entry.data.video_url ? (
          /* CONTAINER: Variable height based on screen, fits any video ratio */
          <div class="relative w-full h-[60vh] md:h-[80vh] flex justify-center items-center bg-black">
         
            <video 
              src={entry.data.video_url} 
              autoplay muted loop playsinline 
              class="absolute inset-0 w-full h-full object-cover opacity-30 blur-xl scale-110"
            />
            <video 
              src={entry.data.video_url} 
              controls autoplay muted loop playsinline 
              class="relative z-10 w-full h-full object-contain shadow-2xl"
            />
            
          </div>
        ) : (
          <img src={entry.data.image} alt={entry.data.title} class="w-full h-auto object-cover" />
        )}

      </div>

      <article class="prose prose-invert max-w-none">
        <Content />
      </article>
    </main>
  </body>
</html>